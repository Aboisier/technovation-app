<% provide :title, "Viewing #{@account.scope_name.titleize}" %>

<div class="grid grid--justify-space-around">
  <div class="grid__col-auto">
    <div class="grid__cell">
      <div class="panel">
        <% if params[:review_before] || params[:back] %>
          <div class="grid__cell">
            <%= link_to params[:back] ||= :back, class: "button secondary" do %>
              <span class="back-btn"></span>
              <%= params[:back_title] ||= "Search results" %>
            <% end %>
          </div>
        <% end %>

        <h3>
          <%= @account.scope_name.titleize %> &mdash; <%= @account.full_name %>
        </h3>

        <%= image_tag @account.profile_image_url,
          class: "thumbnail-lg grid__cell-img" %>

        <p>
          <%= link_to "Login as #{@account.full_name}",
            admin_participant_session_path(@account),
            class: "button secondary small" %>
        </p>

        <dl>
          <dt><%= t('models.account.full_name') %></dt>
          <dd><%= @account.full_name %></dd>

          <dt><%= t('models.account.email') %></dt>
          <dd><%= mail_to @account.email %></dd>

          <dt><%= t('models.account.age') %></dt>
          <dd><%= @account.age %></dd>

          <% unless @account.student_profile.present? %>
            <dt><%= t('models.account.gender') %></dt>
            <dd><%= @account.gender %></dd>
          <% end %>

          <dt><%= t('models.account.address') %></dt>
          <dd>
            <%= @account.address_details %>

            <p>
              <%= link_to "Edit location",
                edit_admin_profile_location_path(@account),
                class: "button secondary small" %>
            </p>
          </dd>

          <%= render "#{@account.scope_name}/profiles/profile",
            edit_path: edit_admin_participant_path(@account),
            editing: true,
            account: @account.public_send("#{@account.scope_name}_profile") %>

          <% if @account.regional_ambassador_profile || @account.mentor_profile %>
            <dt><%= t('models.profile.bio') %></dt>

            <dd>
              <%= simple_format (
                @account.regional_ambassador_profile || @account.mentor_profile
              ).bio %>
            </dd>
          <% end %>
        </dl>

        <%= link_to 'Edit participant',
          edit_admin_participant_path(@account),
          class: "button secondary small" %>
      </div>
    </div>
  </div>
</div>

<div class="grid grid--justify-space-around">
  <div class="grid__col-auto grid__col--bleed-x">
    <div class="panel">
      <% if @account.student_profile %>
        <%= render 'admin/participants/student_debugging',
          profile: @account.student_profile %>
      <% end %>

      <% if @account.regional_ambassador_profile %>
        <%= render 'admin/participants/ra_debugging',
          profile: @account.regional_ambassador_profile %>
      <% end %>

      <% if @account.judge_profile %>
        <%= render 'admin/participants/judge_debugging',
          profile: @account.judge_profile %>
      <% end %>

      <% if @account.mentor_profile %>
        <%= render 'admin/participants/mentor_debugging',
          profile: @account.mentor_profile %>
      <% end %>
    </div>

    <div class="panel">
      <% if @account.mentor_profile || @account.student_profile %>
        <h6>
          <%= t("views.student.mentors.show.teams",
                name: @account.first_name) %>
        </h6>

        <% if @account.current_teams.any? %>
          <ul class="reset">
            <%= render partial: 'student/mentors/team_preview',
              collection: @account.current_teams,
              locals: {
                admin: true,
                profile: @account.mentor_profile || @account.student_profile
              } %>
          </ul>
        <% else %>
          <p>
            <%= t("views.student.mentors.show.no_teams",
                  name: @account.first_name) %>
          </p>
        <% end %>
      <% end %>
    </div>

    <div class="panel">
      <% if @account.mentor_profile %>
        <%= link_to(
          "Drop #{@account.first_name} out of Season #{Season.current.year}",
          admin_mentor_drop_out_path(id: @account.mentor_profile.id),
          class: "button danger",
          data: {
            method: :post,
            confirm: "Are you sure you want to DROP #{@account.first_name} OUT from Season #{Season.current.year}?",
          }
        ) %>
      <% end %>

      <% if @account.student_profile and @account.parental_consent.nil? %>
        <%= link_to "Indicate that a paper parental consent on file",
          admin_paper_parental_consent_path(id: @account.student_profile.id),
          class: "button secondary",
          data: {
            method: :post,
            confirm: "You are marking #{@account.full_name} as having a paper parental consent on file.",
          } %>
      <% end %>
    </div>
  </div>
</div>
