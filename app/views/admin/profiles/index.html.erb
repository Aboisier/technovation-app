<div class="flex-row">

  <div class="flex-col-md-4">
    <div class="admin-search__filter-options">
      <label class="no-text-transform">
        Search by name or email:
        <%= text_field_tag :text, params[:text], class: "submit-on-enter",
        placeholder: "Press enter after typing",
        data: { param: :text } %>
      </label>

      <label class="no-text-transform">
        Season:<br />
        <%= select_tag :season,
          options_for_select(Season.pluck(:year).sort.reverse, params[:season]),
          class: "inline",
          data: { reload: true, param: :season } %>
      </label>

      <label class="no-text-transform">
        Account type:<br />
        <%= select_tag :type,
          options_for_select(%w{All Mentor Student RegionalAmbassador Judge}, params[:type]),
          class: "inline",
          data: { reload: true, param: :type } %>
      </label>

      <% if params[:type] == "Student" %>
        <label class="no-text-transform">
          Parental Consent Status:<br />
          <%= select_tag :parental_consent_status,
            options_for_select(%w{All Signed Sent No\ Info\ Entered},
                               params[:parental_consent_status]),
          class: "inline",
          data: { reload: true, param: :parental_consent_status } %>
        </label>
      <% end %>

      <% if params[:type] == "Mentor" %>
        <label class="no-text-transform">
          On a team:<br />
          <%= select_tag :team_status,
            options_for_select(%w{All Needs\ background\ check Needs\ consent\ waiver On\ a\ team No\ team}, params[:team_status]),
            class: "inline",
            data: { reload: true, param: :team_status } %>
        </label>
      <% end %>

      <label class="no-text-transform">
        How did you hear about us?<br />
        <%= select_tag :how_heard,
          options_for_select(["All"] + Account.referred_bies.keys, params[:how_heard]),
          class: "inline",
          data: {
            reload: true,
            param: :how_heard,
          } %>
      </label>
    </div>
  </div>

  <div class="flex-col-md-8 wrapper__report-column">
    <div class="scrolly-table">
      <div class="scrolly-table__overflow-handler">
        <table>
          <thead>
            <tr>
              <th>Type</th>
              <th>Signed up</th>
              <th>Name</th>
              <th>Email</th>
              <th>Division</th>
              <th>Referred by</th>
              <th>Location</th>
            </tr>
          </thead>

          <tbody>
            <% @accounts.each do |account| %>
              <% cache(account) do %>
                <tr>
                  <td><%= account.type_name %></td>
                  <td><%= account.created_at.strftime("%m/%d/%Y") %></td>
                  <td><%= link_to account.full_name, admin_profile_path(account) %></td>
                  <td><%= mail_to account.email %></td>
                  <td><%= account.division %></td>
                  <td><%= account.referred_by %> <%= account.referred_by_other %></td>
                  <td><%= account.address_details %></td>
                </tr>
              <% end %>
            <% end %>
          </tbody>
        </table>
      </div>
    </div>

    <div class="wrapper__report-footer">
      <div class="pagination_info">
        <%= page_entries_info @accounts,
          model: params[:type] == "All" ? "Account" : params[:type] %>
      </div>

      <%= will_paginate @accounts %>

      <label class="no-text-transform per_page">
        Per page:
        <%= select_tag :per_page,
        options_for_select([10, 25, 50, 100], params[:per_page]),
        class: "inline",
        data: {
          reload: true,
          param: :per_page,
        } %>
      </label>

      <div class="clearfix admin-search__export-options">
        <hr />

        <%= form_tag admin_exports_path(params.merge(class: "account")) do %>
          <%= button_tag "Email CSV Report to:", class: "appy-button" %>
          <%= text_field_tag :export_email, cookies[:export_email], class: "export-to-email" %>
        <% end %>
      </div>
    </div>
  </div>

</div>
